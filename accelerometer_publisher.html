<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>radiate : accelerometer : publisher</title>
        <style>
            body {
              font: 300% VT323, monospace;
              padding: 20px;
              background: #000;
              color: #FFF;
            }
        </style>
        <link href="http://fonts.googleapis.com/css?family=VT323" rel="stylesheet" type="text/css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    </head>
    <body>
        <div id="alpha">?</div>
        <div id="beta">?</div>
        <div id="gamma">?</div>

        <script src="http://code.jquery.com/jquery-latest.js"></script>

        <script>
            (function() {
                if (window.DeviceOrientationEvent) {
                    var timeout;
                    $(window).on('deviceorientation', function(e) {
                        var oe = e.originalEvent;
                        $('#alpha').text(oe.alpha);
                        $('#beta').text(oe.beta);
                        $('#gamma').text(oe.gamma);
                        if (!timeout) {
                            $.ajax('http://radiate.herokuapp.com/orientation', {
                                type: 'PUT',
                                dataType: 'json',
                                data: {
                                    value: (oe.alpha+0) + '|' + (oe.beta+0) + '|' + (oe.gamma+0)
                                }
                            });
                            timeout = setTimeout(function() { timeout = null; }, 500);
                        }
                    });
                }
            })();
        </script>
    </body>
</html>
