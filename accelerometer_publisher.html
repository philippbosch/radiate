<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>radiate : accelerometer : publisher</title>
        <style>
            body {
                font: 300% VT323, monospace;
                padding: 20px;
                background-color: #000;
                color: #FFF;
            }
        </style>
        <link href="http://fonts.googleapis.com/css?family=VT323" rel="stylesheet" type="text/css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    </head>
    <body>
        <div id="alpha">?</div>

        <script src="http://code.jquery.com/jquery-latest.js"></script>

        <script>
            (function() {
                if (window.DeviceOrientationEvent) {
                    var currentAlpha = 0;
                    var previousAlpha = 0;

                    $(window).on('deviceorientation', function(e) {
                        var alpha = Math.round(e.originalEvent.alpha);
                        $('#alpha').text(alpha);
                        currentAlpha = alpha;
                        $('body').css('background', 'hsl(' + alpha + ', 100%, 50%)')
                    });

                    setInterval(function() {
                        if (currentAlpha != previousAlpha) {
                            $.ajax('http://radiate.herokuapp.com/orientation', {
                                type: 'PUT',
                                dataType: 'json',
                                data: {
                                    value: currentAlpha
                                }
                            });
                            previousAlpha = currentAlpha;
                        }
                    }, 500);
                }
            })();
        </script>
    </body>
</html>
